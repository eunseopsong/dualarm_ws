# Dual Arm & Hand Force Control Package

μ΄ ν¨ν‚¤μ§€λ” Isaac Sim ν™κ²½μ—μ„ κµ¬λ™λλ” **μ–‘ν”(12-DOF) λ° μ–‘μ†(40-DOF) λ΅λ΄‡μ„ ROS 2λ¥Ό ν†µν•΄ ν†µν•© μ μ–΄ν•κ³  λ¨λ‹ν„°λ§**ν•κΈ° μ„ν•΄ κ°λ°λμ—μµλ‹λ‹¤. 

μ΄ 52κ°μ μ΅°μΈνΈ(Joint)μ™€ μ ‘μ΄‰λ ¥(Contact Force) λ°μ΄ν„°λ¥Ό μ‹¤μ‹κ°„μΌλ΅ νμ‹±ν•λ©°, ν„°λ―Έλ„ μƒμ—μ„ μ§κ΄€μ μΈ UIλ¥Ό ν†µν•΄ λ΅λ΄‡μ ν„μ¬ μƒνƒ(Current)μ™€ λ©ν‘ μƒνƒ(Target)λ¥Ό ν•λμ— ν™•μΈν•  μ μμµλ‹λ‹¤.

---

## β¨ μ£Όμ” κΈ°λ¥ (Key Features)

* **52-DOF ν†µν•© μ μ–΄**: μ–‘ν” 12κ°, μ–‘μ† 40κ°μ μ΅°μΈνΈλ¥Ό ν•λ‚μ λ°°μ—΄λ΅ λ¬¶μ–΄ λ™μ‹μ— μ μ–΄ν•©λ‹λ‹¤. (Isaac Simμ λ¬΄μ‘μ„ μ΅°μΈνΈ λ°°μ—΄ μμ„λ¥Ό μλ™ λ§¤ν•‘)
* **μƒνƒ λ¨λ‹ν„°λ§ UI**: ν„°λ―Έλ„μ— ν„μ¬ κ°’(μ²­λ΅μƒ‰)κ³Ό νƒ€κ² κ°’(λ…Έλ€μƒ‰)μ„ κΉ”λ”ν• ν‘ ν•μ‹μΌλ΅ μ¶λ ¥ν•μ—¬ μ§κ΄€μ μΈ λ¨λ‹ν„°λ§μ΄ κ°€λ¥ν•©λ‹λ‹¤.
* **μ ‘μ΄‰λ ¥(Contact Force) λ¨λ‹ν„°λ§**: λ΅λ΄‡ ν”κ³Ό μ†κ°€λ½ λμ— μ‘μ©ν•λ” ν(Fx, Fy, Fz) λ°μ΄ν„°λ¥Ό μ‹¤μ‹κ°„μΌλ΅ μμ‹  λ° μ¶λ ¥ν•©λ‹λ‹¤.
* **μ•μ „ν• μ μ–΄ λ¨λ“ κ΄€λ¦¬ (`idle` / `forward`)**:
  * **`idle` (μ΄κΈ° λ€κΈ° λ¨λ“)**: μµμ΄ μ‹¤ν–‰ μ‹ λ΅λ΄‡μ ν„μ¬ μ„μΉλ¥Ό μΊ΅μ²ν•μ—¬ λ©ν‘ κ°’μΌλ΅ λ‹¨λ‹¨ν κ³ μ •ν•©λ‹λ‹¤. μ¤‘λ ¥μ— μν• λ΅λ΄‡μ λ―Έμ„Έν• νλ¬λ‚΄λ¦Ό(Drift) ν„μƒμ„ μ™„λ²½ν λ°©μ§€ν•©λ‹λ‹¤.
  * **`forward` (νƒ€κ² μ¶”μΆ… λ¨λ“)**: μ‚¬μ©μκ°€ μ…λ ¥ν• μ΅°μΈνΈ νƒ€κ² λ…λ Ήμ–΄(`/forward_joint_targets`)λ¥Ό μ¶”μΆ…ν•μ—¬ λ΅λ΄‡μ΄ μ›€μ§μ…λ‹λ‹¤.
  * **μ„λΉ„μ¤ μ½ μ „ν™**: ROS 2 Service Callμ„ ν†µν•΄ μ‹¤ν–‰ μ¤‘ μ‹¤μ‹κ°„μΌλ΅ λ‘ λ¨λ“λ¥Ό μ•μ „ν•κ² ν† κΈ€ν•  μ μμµλ‹λ‹¤.

---

## π“΅ ν†µμ‹  κ·κ²© (Nodes, Topics & Services)

* **Node Name:** `dualarm_ctrl` (Package: `dualarm_forcecon`)
* **Subscribed Topics:**
  * `/isaac_joint_states` (`sensor_msgs/msg/JointState`): Isaac Simμ—μ„ λ³΄λ‚΄λ” ν„μ¬ μ΅°μΈνΈ μƒνƒ
  * `/isaac_contact_states` (`std_msgs/msg/Float64MultiArray`): μ–‘ν” λ° μ–‘μ†μ μ ‘μ΄‰λ ¥ λ°μ΄ν„°
  * `/forward_joint_targets` (`std_msgs/msg/Float64MultiArray`): 52-DOF νƒ€κ² μ΅°μΈνΈ λ…λ Ήμ–΄
* **Published Topics:**
  * `/isaac_joint_command` (`sensor_msgs/msg/JointState`): Isaac SimμΌλ΅ μ „μ†΅λλ” μ„μΉ μ μ–΄ λ…λ Ή
* **Services:**
  * `/change_control_mode` (`std_srvs/srv/Trigger`): `idle` β†” `forward` μ μ–΄ λ¨λ“λ¥Ό ν† κΈ€(Toggle)

---

## π€ νν† λ¦¬μ–Ό λ° μ‚¬μ© λ°©λ²• (How to Use)

### 1. ν¨ν‚¤μ§€ λΉλ“ λ° λ…Έλ“ μ‹¤ν–‰
μ‘μ—… κ³µκ°„(Workspace)μ—μ„ ν¨ν‚¤μ§€λ¥Ό λΉλ“ν•κ³  λ…Έλ“λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

    colcon build --packages-select dualarm_forcecon
    source install/setup.bash
    ros2 run dualarm_forcecon dualarm_ctrl

> **μ°Έκ³ :** λ…Έλ“κ°€ μ‹¤ν–‰λλ©΄ μλ™μΌλ΅ `idle` λ¨λ“λ΅ μ‹μ‘λλ©°, λ΅λ΄‡μ€ ν„μ¬ μμ„Έλ¥Ό κµ³κ±΄ν μ μ§€ν•©λ‹λ‹¤. λ¨λ‹ν„°λ§ UIκ°€ ν„°λ―Έλ„μ— μ¶λ ¥λ©λ‹λ‹¤.

### 2. μ μ–΄ λ¨λ“ λ³€κ²½ (`idle` -> `forward`)
μƒλ΅μ΄ ν„°λ―Έλ„μ„ μ—΄κ³ , λ΅λ΄‡μ„ μ›€μ§μ΄κΈ° μ„ν•΄ μ μ–΄ λ¨λ“λ¥Ό `forward`λ΅ λ³€κ²½ν•©λ‹λ‹¤. (λ‹¤μ‹ ν• λ² μ…λ ¥ν•λ©΄ `idle` μƒνƒλ΅ λμ•„μµλ‹λ‹¤.)

    ros2 service call /change_control_mode std_srvs/srv/Trigger

### 3. μ–‘ν” λ° ν•Έλ“ μ μ–΄ λ…λ Ήμ–΄ μ „μ†΅ (Topic Publish)
`forward` λ¨λ“ μƒνƒμ—μ„ `/forward_joint_targets` ν† ν”½μΌλ΅ μ΅°μΈνΈ λ°°μ—΄ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•©λ‹λ‹¤.
λ°μ΄ν„°λ” μ΄ 52κ°μ `float64` λ°°μ—΄λ΅ κµ¬μ„±λμ–΄μ•Ό ν•©λ‹λ‹¤.
* **[0~5]**: μ™Όν” / **[6~11]**: μ¤λ¥Έν”
* **[12~31]**: μ™Όμ† (μ—„μ§€~μƒλΌ, κ° 4-DOF) / **[32~51]**: μ¤λ¥Έμ† (μ—„μ§€~μƒλΌ, κ° 4-DOF)

**π“ μ‹¤ν–‰ μμ‹: μ–‘ν”μ€ νΉμ • μμ„Έλ΅ μ΄λ™/μ μ§€ν•κ³ , μ–‘μ†μ λ¨λ“  μ†κ°€λ½ κ΄€μ μ„ 0.5 λΌλ””μ•(μ•½ 28λ„) κµ¬λ¶€λ¦¬κΈ°**
*(μ•„λ λ…λ Ήμ–΄λ¥Ό ν• λ²μ— λ³µμ‚¬ν•μ—¬ ν„°λ―Έλ„μ— λ¶™μ—¬λ„£μΌμ„Έμ”.)*

    ros2 topic pub -1 /forward_joint_targets std_msgs/msg/Float64MultiArray "{data: [
    0.0, -0.78, -2.00, -0.24, 1.34, 0.37, 
    0.0, 0.79, 2.00, 0.24, -1.33, -0.42, 
    0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 
    0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}"

> π’΅ **Tip:** μ†κ°€λ½μ„ λ‹¤μ‹ κ³§κ² ν΄κ³  μ‹¶λ‹¤λ©΄ λ…λ Ήμ–΄ λ’·λ¶€λ¶„μ `0.5` λ°°μ—΄ κ°’λ“¤μ„ λ¨λ‘ `0.0`μΌλ΅ μμ •ν•μ—¬ λ‹¤μ‹ Publish ν•μ‹λ©΄ λ©λ‹λ‹¤.
